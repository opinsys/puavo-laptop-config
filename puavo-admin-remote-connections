#!/bin/sh

set -e

usage() {
  cat <<'EOF'
Usage:

  puavo-admin-remote-connections --accept-incoming
                                 --is-incoming-accepted
                                 --reject-incoming

  Give one of "--accept-incoming", "--is-incoming-accepted" or
   "--reject-incoming" options.  If connections are accepted,
   "--is-incoming-accepted" prints "yes" to standard output,
   and "no" if those are rejected.
EOF
}

action=$1

set -u

config_file_path="/var/lib/puavo-desktop/shared/puavo-admin-remote-connections.conf"

case "$action" in
  --accept-incoming)
    touch "$config_file_path"
    ;;
  -h|--help)
    usage
    exit 0
    ;;
  --is-incoming-accepted)
    if [ -e "$config_file_path" ]; then
      echo yes
    else
      echo no
    fi
    ;;
  --reject-incoming)
    rm -f "$config_file_path"
    ;;
  *)
    usage >&2
    exit 1
    ;;
esac
